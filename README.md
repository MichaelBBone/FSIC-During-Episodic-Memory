# FSIC-During-Episodic-Memory
Code and data repository for "Feature-Specific Neural Reactivation during Episodic Memory". 

Download the release for all files. Only the release contains the neural activity data (used in FeatSpecifReac.R) due to file size limitations.

## Scripts

Contains four R scripts and the required data to run the scripts independently, i.e. the reactivation data can be generated by running FeatSpecifReac.R, but the pre-generated data (ReacRankRecall.RData) is used in FSIC.R and ReacCorVivAcc.R.

The scripts are as follows (see the scripts for more detail):

FeatSpecifReac.R - code for generating feature-specific neural reactivation values

FSIC_Sim.R - code for the neural simulation depicted in Figure 3

FSIC.R - code for FSIC results depicted in Figure 4

ReacCorVivAcc.R - code for the behavioral correlation results depicted in Figure 5


## Data

<b>DNN Feature activiations:</b>

DNN\<feature level\>ImMat(3X3).mat - matlab matrix data file containing features (columns) extracted from VGG16 for all 180 study images (rows). 'feature level' refers to the layer of VGG16 that the features were drawn from. The levels are the last convolution or fully connected layers in each set of layers divided by the max pooling layers. L1 = conv layer 2, L2 = conv layer 4, L3 = conv layer 7, L4 = conv layer 10, L5 = conv layer 13, FC3 = fully-connected layer 3. L2 and L4 were not used in the study. All layers except the fully connected layer were downsampled to 3x3.

DNN\<feature level\>Mix1Mat(3X3)HR.mat - matlab matrix data file containing hemodynamically smoothed features (columns) for all time-points (rows) extracted from VGG16 for movie 1.

DNN\<feature level\>Mix2Mat(3X3)HR.mat - matlab matrix data file containing hemodynamically smoothed features (columns) for all time-points (rows) extracted from VGG16 for movie 2.

<b>Brain (vertex) activity:</b>

ROINamesDiv.RData - R data file containing a list of FreeSurfer ROI groupings. ROI groupings: 1 = 'LowOc' (lower occipital), 2 = 'HighOc' (higher occipital), 3 = 'Tmprl' (temporal), 4 = 'Prtl' (parietal), 5 = 'Front' (frontal), 6 = 'Other'.

roiNodeNames\<ROI\>.RData - R data file containing the FreeSurfer ROI each vertex belongs to. Data in the form of lists (names = subjects) of vectors containing roi names. ROIs refer to the groupings in ROINamesDiv.RData.

movie\<ROI\>.RData - R data file containing vertex activity for movie 1 (movie2VntrDatSep) and movie 2 (movie3VntrDatSep). Data in the form of lists (names = subjects) of matrices (row = time point, column = brain vertex).

nback\<ROI\>.RData - R data file containing vertex activity for the n-back/encoding task. Data in the form of lists (names = subjects) of matrices (row = trial, column = brain vertex).

recogVis\<ROI\>.RData - R data file containing vertex activity for the recall task. Data in the form of lists (names = subjects) of matrices (row = image (in alphabetical order), column = brain vertex).

recogPrb\<ROI\>.RData - R data file containing vertex activity for the old/new recognition task. Data in the form of lists (names = subjects) of matrices (row = image (in alphabetical order), column = brain vertex).

<b>Image names:</b>

imageNames.RData - R data file containing all image file names (nBackImagesAll), the image for each n-back/encoding trial (nBackImages), the cued recall images for each image and time point sorted alphabetically (recogImages), and the recognition probe images for each image and time point sorted alphabetically (recogProbes). There are 16 recall/recognition time points, so each image name is repeated 16 times in recogImages and recogProbes.

<b>FreeSurfer ROI names:</b>

ROINamesNum.RData - R data file containing a vector of FreeSurfer numerical ROI names (only left hemisphere because it was used to represent bilateral ROIs)

ROINamesFreeSurf.RData - R data file containing a vector mapping between FreeSurfer numerical and descriptive ROI names.

<b>Seed weights:</b>

ROINamesFreeSurf.RData - R data file containing an array of seed weights depicted in Figure 4a (row = ROI, column = seed level).

<b>Reactivation (rank) and behavioral data:</b>

ReacRankRecall.RData - R data file containing the recall reactivation and behavioral data in data.frame format. Trials for each subject are along the rows (sorted alphabetically by cue label, not in temporal order). Columns: see FSIC.R or ReacCorVivAcc.R for a detailed description of the columns.

<b>Simulated reactivation (rank) data:</b>

simRankIdenticalMem200Sub.RData - R data file containing simulated reactivation data (identical trial-by-trial memory accuracy across feature levels) used in study.

simRankIndependantMem200Sub.RData - R data file containing simulated reactivation data (independant trial-by-trial memory accuracy across feature levels) used in study.

<b>Pre-generated stats (because some stats can take >1 hour to generate):</b>

reacFSICStats.RData - R data file containing FSIC statistics for all ROIs (used in Figure 4b). All data in 3-D array format (dim 1 = ROI, dim 2 = feature level, dim 3 = seed level). R data file contains coefficients (CorVals), t values (TVals), p values (PVals), 90% CI upper bounds (UBVals), and 90% CI lower bounds (LBVals).

simRankIdenticalMem200Sub_MeanStats.RData - R data file containing simulated mean reactivation (identical trial-by-trial memory accuracy across feature levels) (Figure 2a). All data in 2-D array format (dim 1 = ROI, dim 2 = feature level). R data file contains coefficients (CorVals), t values (TVals), p values (PVals), 90% CI upper bounds (UBVals), and 90% CI lower bounds (LBVals).

simRankIdenticalMem200Sub_FSICStats.RData - R data file containing simulated FSIC statistics (identical trial-by-trial memory accuracy across feature levels) (Figure 2b and Supplementary Figure 4b). All data in 3-D array format (dim 1 = ROI, dim 2 = feature level, dim 3 = seed level). R data file contains coefficients (CorVals), t values (TVals), p values (PVals), 90% CI upper bounds (UBVals), and 90% CI lower bounds (LBVals).

simRankIndependantMem200Sub_FSICStats.RData - R data file containing simulated FSIC statistics (independant trial-by-trial memory accuracy across feature levels) (Supplementary Figure 4c). All data in 3-D array format (dim 1 = ROI, dim 2 = feature level, dim 3 = seed level). R data file contains coefficients (CorVals), t values (TVals), p values (PVals), 90% CI upper bounds (UBVals), and 90% CI lower bounds (LBVals).
